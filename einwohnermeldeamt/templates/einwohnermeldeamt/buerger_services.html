{% load static %}
<html lang="de">
    <head>
        <meta charset="UTF-8">
        <link rel="stylesheet" href="{% static 'styletest.css' %}">
        <title>Bürgerservices</title>
        <style>
            #wohnsitz-section {
                display: none;
            }
            #standesamt-section {
                display: none;
            }
        </style>
    </head>
    <body>
                            <!-- TOP BAR -->
        <div class="topbar">
                                <!-- USER BUTTON (rechts oben) -->
            <div class="usermenu_show_button">
                <p>Max Mustermann</p>
            </div>
            <button class="navbar_show_button" onclick="document.querySelector('.navbar').classList.remove('hidden')">Menü</button>

        </div>
        <!-- Button zum Anzeigen der Navbar -->
                    <!-- NAVBAR -->
        <nav class="navbar hidden">
                <!-- Button zum Verstecken der Navbar -->
            <div class="navbar_hide_button" onclick="hideNavbar()">
                <span class="close-icon"></span>
                <h3>Menü</h3>
            </div>
                            <!-- MENÜPUNKTE -->
            <div class="menu_items">
                <div class="menu_item" onclick="selectItem(this)">Hauptseite</div>
                <div class="menu_item" onclick="selectItem(this)">Amt für Meldewesen - Bürgerservice</div>
                <div class="menu_item" onclick="selectItem(this)"></div>
            </div>
                
        </nav>
        <h1>Bürgerservices</h1>

        <form method="POST" action="{% url 'buerger_services' %}">                <!-- Korrelation zur views.py Funktion "Wohnsitz anmelden" -->    
            {% csrf_token %}
            <label for="Formulare_Meldeamt">Formulare Meldeamt</label>
            <select id="Formulare_Meldeamt" name="Formulare_Meldeamt">
                <option value="">Formular auswählen</option>
                <option value="wohnsitz">Wohnsitz anmelden</option>
                <option value="standesamt">Standesamt</option>
            </select>

            <fieldset id="wohnsitz-section">
                <legend>Wohnsitz anmelden</legend>

                <label for="buerger_id">Bürger-ID:</label>                          <!-- später prüfen durch public key -->    
                <input type="text" id="buerger_id" name="buerger_id"><br>  <!-- required wird entfernt, sonst kann man erst Hochzeit durchführen, wenn Wohnsitz davor durchgeführt -->    

                <label for="adresse_id">Straße und Hausnummer:</label>
                <select id="adresse_id" name="adresse_id" required>
                    <option value="">Adresse auswählen</option>
                    {% for adr in adressen %}
                        <option value="{{ adr.id }}">{{ adr.label }}</option>
                    {% endfor %}
                </select>

                <button type="submit">Eingabe</button>
            </fieldset>

            <fieldset id="standesamt-section">
                {#                                                              <!-- Django-Syntax Zeile 71-75 erst mal deaktiviert -->  
                {% if not user.groups.filter(name="Mitarbeiter").exists %}
                    style="display: none;"
                {% endif %}
                #}
                <legend>Standesamt</legend>

                <label for="namensaenderung_b_id1">Bürger-ID (Person, bei der der Nachname nicht geändert wird)</label>
                <input type="text" id="namensaenderung_b_id1" name="b_id_1"><br>

                <label for="namensaenderung_b_id2">Bürger-ID (Person, bei der der Nachname geändert wird)</label>
                <input type="text" id="namensaenderung_b_id2" name="b_id_2"><br>

                <label for="eheschliessungsdatum">Eheschließungsdatum:</label>
                <input type="date" id="eheschliessungsdatum" name="eheschliessungsdatum"><br>

                <label for="neuerNachname">Neuer Nachname:</label>
                <input type="text" id="neuerNachname" name="neuerNachname"><br>

                <button type="submit">Eingabe</button>
            </fieldset>
        </form>

        <script>
            // Wir holen uns das Auswahlfeld und beide Abschnitte
            const vorgangSelect = document.getElementById("Formulare_Meldeamt");
            const wohnsitzSection = document.getElementById("wohnsitz-section");
            const standesamtSection = document.getElementById("standesamt-section");

            // Wenn sich die Auswahl ändert, wird diese Funktion ausgeführt
            vorgangSelect.addEventListener("change", function() {
                const auswahl = vorgangSelect.value;
                    
                // Alles zuerst ausblenden
                wohnsitzSection.style.display = "none";
                standesamtSection.style.display = "none";

                // Je nach Auswahl das richtige anzeigen
                if (auswahl === "wohnsitz") {
                    wohnsitzSection.style.display = "block";
                } 
                if (auswahl === "standesamt") {
                    standesamtSection.style.display = "block";
                }
            })
        </script>
        <script>
            function hideNavbar() {
                document.querySelector(".navbar").classList.add("hidden");
            }
        </script>
    </body>
</html>